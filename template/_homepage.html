{% extends "_layout.html" %}

{% block title %}{% endblock title %}

{% block stylesheets %}
{{ block.super }}
{% endblock stylesheets %}

{% block content %}
<div class="right_col" role="main">
  <div class="">
    <div class="page-title">

      <!-- top tiles -->
      <div class="row tile_count">
        <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
          <span class="count_top" style="font-size: 16px;"><i class="fa fa-fax"></i> 商店总数</span>
          <div class="count"><a href="/shop/list" style="font-size: 30px; color: #124076;">{{ shop_total
              }}</a></div>

        </div>

        <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
          <span class="count_top" style="font-size: 16px;"><i class="fa fa-list-ol"></i> 供应商总数</span>
          <div class="count"><a href="/supplier/list" style="font-size: 30px; color: #124076;">{{
              supplier_total }}</a></div>

        </div>

        <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
          <span class="count_top" style="font-size: 16px;"><i class="fa fa-users"></i> 员工总数</span>
          <div class="count"><a href="/shop/0/salesman" style="font-size: 30px; color: #124076;">{{ user_total
              }}</a></div>

        </div>

        <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
          <span class="count_top" style="font-size: 16px;"><i class="fa fa-list-alt"></i> 商品总数</span>
          <div class="count"><a href="/goods/list" style="font-size: 30px; color: #0C359E;">{{ goods_total
              }}</a></div>

        </div>

        <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
          <span class="count_top" style="font-size: 16px;"><i class="fa fa-line-chart"></i> 总销售额</span>
          <div class="count"><a href="/sale/list" style="font-size: 30px; color: #087E65;">
              {{ sale_total }}</a></div>

        </div>

        <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
          <span class="count_top" style="font-size: 16px;"><i class="fa fa-envelope"></i> 总提醒数</span>
          <div class="count"><a href="/mail/0/list" style="font-size: 30px; color: #F07B3F;">
              {{ mail_total }}</a></div>
        </div>
      </div>
      <!-- /top tiles -->
    </div>

    <div class="clearfix"></div>

    <div class="row">
      <div class="col-md-8 col-sm-8 col-xs-12">
        <div class="x_panel">
          <div class="x_title">
            <h2>近三个月总体销售情况</h2>
            <ul class="nav navbar-right panel_toolbox">
              <li><a><i class="fa fa-bookmark-o" style="color: white;"></i></a></li>
              <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
              </li>
              <li><a class="close-link"><i class="fa fa-close"></i></a>
              </li>
            </ul>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">

            <div id="mainb" style="height:370px;"></div>

          </div>
        </div>
      </div>

      <div class="col-md-4 col-sm-4 col-xs-12">
        <div class="x_panel">
          <div class="x_title">
            <h2>近三个月销售额前五商店</h2>
            <ul class="nav navbar-right panel_toolbox">
              <li><a><i class="fa fa-bookmark-o" style="color: white;"></i></a></li>
              <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
              </li>
              <li><a class="close-link"><i class="fa fa-close"></i></a>
              </li>
            </ul>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">

            <div id="echart_bar_horizontal" style="height:370px;"></div>

          </div>
        </div>
      </div>

      <div class="col-md-8 col-sm-8 col-xs-12">
        <div class="x_panel">
          <div class="x_title">
            <h2>历史销售额的地区分布情况</h2>
            <ul class="nav navbar-right panel_toolbox">
              <li><a><i class="fa fa-bookmark-o" style="color: white;"></i></a></li>
              <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
              </li>
              <li><a class="close-link"><i class="fa fa-close"></i></a>
              </li>
            </ul>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">

            <div id="echart_world_map" style="height:370px;"></div>

          </div>
        </div>
      </div>

      <div class="col-md-8 col-sm-8 col-xs-12">
        <div class="x_panel">
          <div class="x_title">
            <h2>历史运营记录的时间分布情况</h2>
            <ul class="nav navbar-right panel_toolbox">
              <li><a><i class="fa fa-bookmark-o" style="color: white;"></i></a></li>
              <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
              </li>
              <li><a class="close-link"><i class="fa fa-close"></i></a>
              </li>
            </ul>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">

            <div id="echart_line" style="height:370px;"></div>

          </div>
        </div>
      </div>

      <div class="col-md-4 col-sm-4 col-xs-12">
        <div class="x_panel">
          <div class="x_title">
            <h2>历史销售额的类别分布情况</h2>
            <ul class="nav navbar-right panel_toolbox">
              <li><a><i class="fa fa-bookmark-o" style="color: white;"></i></a></li>
              <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
              </li>
              <li><a class="close-link"><i class="fa fa-close"></i></a>
              </li>
            </ul>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">

            <div id="echart_donut" style="height:370px;"></div>

          </div>
        </div>
      </div>


      <div class="col-md-4 col-sm-4  ">
        <div class="x_panel">
          <div class="x_title">
            <h2>销售净利率</h2>
            <ul class="nav navbar-right panel_toolbox">
              <li><a><i class="fa fa-bookmark-o" style="color: white;"></i></a></li>
              <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
              </li>
              <li><a class="close-link"><i class="fa fa-close"></i></a>
              </li>
            </ul>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">
            <div id="echart_gauge" style="height:370px;"></div>
          </div>
        </div>
      </div>


    </div>
  </div>
</div>
{% endblock content %}

{% block javascripts %}
{{ block.super }}
<!-- ECharts -->
<script src="/static/vendors/echarts/dist/echarts.min.js"></script>
<script src="/static/vendors/echarts/map/js/china.js"></script>
<script type="text/javascript">
  //echart Bar 1
  var theme = {
    color: [
      '#26B99A', '#34495E', '#BDC3C7', '#3498DB',
      '#9B59B6', '#8abb6f', '#759c6a', '#bfd3b7'
    ],

    title: {
      itemGap: 8,
      textStyle: {
        fontWeight: 'normal',
        color: '#408829'
      }
    },

    dataRange: {
      color: ['#1f610a', '#97b58d']
    },

    toolbox: {
      color: ['#408829', '#408829', '#408829', '#408829']
    },

    tooltip: {
      backgroundColor: 'rgba(0,0,0,0.5)',
      axisPointer: {
        type: 'line',
        lineStyle: {
          color: '#408829',
          type: 'dashed'
        },
        crossStyle: {
          color: '#408829'
        },
        shadowStyle: {
          color: 'rgba(200,200,200,0.3)'
        }
      }
    },

    dataZoom: {
      dataBackgroundColor: '#eee',
      fillerColor: 'rgba(64,136,41,0.2)',
      handleColor: '#408829'
    },
    grid: {
      borderWidth: 0
    },

    categoryAxis: {
      axisLine: {
        lineStyle: {
          color: '#408829'
        }
      },
      splitLine: {
        lineStyle: {
          color: ['#eee']
        }
      }
    },

    valueAxis: {
      axisLine: {
        lineStyle: {
          color: '#408829'
        }
      },
      splitArea: {
        show: true,
        areaStyle: {
          color: ['rgba(250,250,250,0.1)', 'rgba(200,200,200,0.1)']
        }
      },
      splitLine: {
        lineStyle: {
          color: ['#eee']
        }
      }
    },
    timeline: {
      lineStyle: {
        color: '#408829'
      },
      controlStyle: {
        normal: { color: '#408829' },
        emphasis: { color: '#408829' }
      }
    },

    k: {
      itemStyle: {
        normal: {
          color: '#68a54a',
          color0: '#a9cba2',
          lineStyle: {
            width: 1,
            color: '#408829',
            color0: '#86b379'
          }
        }
      }
    },
    map: {
      itemStyle: {
        normal: {
          areaStyle: {
            color: '#ddd'
          },
          label: {
            textStyle: {
              color: '#c12e34'
            }
          }
        },
        emphasis: {
          areaStyle: {
            color: '#99d2dd'
          },
          label: {
            textStyle: {
              color: '#c12e34'
            }
          }
        }
      }
    },
    force: {
      itemStyle: {
        normal: {
          linkStyle: {
            strokeColor: '#408829'
          }
        }
      }
    },
    chord: {
      padding: 4,
      itemStyle: {
        normal: {
          lineStyle: {
            width: 1,
            color: 'rgba(128, 128, 128, 0.5)'
          },
          chordStyle: {
            lineStyle: {
              width: 1,
              color: 'rgba(128, 128, 128, 0.5)'
            }
          }
        },
        emphasis: {
          lineStyle: {
            width: 1,
            color: 'rgba(128, 128, 128, 0.5)'
          },
          chordStyle: {
            lineStyle: {
              width: 1,
              color: 'rgba(128, 128, 128, 0.5)'
            }
          }
        }
      }
    },
    gauge: {
      startAngle: 225,
      endAngle: -45,
      axisLine: {
        show: true,
        lineStyle: {
          color: [
            [0.2, '#86b379'],
            [0.8, '#68a54a'],
            [1, '#408829']
          ],
          width: 8
        }
      },
      axisTick: {
        splitNumber: 10,
        length: 12,
        lineStyle: {
          color: 'auto'
        }
      },
      axisLabel: {
        textStyle: {
          color: 'auto'
        }
      },
      splitLine: {
        length: 18,
        lineStyle: {
          color: 'auto'
        }
      },
      pointer: {
        length: '90%',
        color: 'auto'
      },
      title: {
        textStyle: {
          color: '#333'
        }
      },
      detail: {
        textStyle: {
          color: 'auto'
        }
      }
    },
    textStyle: {
      fontFamily: 'Arial, Verdana, sans-serif'
    }
  };

  if ($('#mainb').length) {

    var echartBar = echarts.init(document.getElementById('mainb'), theme);

    var option = {
      // title:
      // text: 'Graph title',
      // subtext: 'Graph Sub-text'
      tooltip: {
        trigger: 'axis'
      },
      legend: {
        data: ['销售额', '净利润']
      },
      toolbox: {
        show: true,
        x: 'right',
        feature: {
          saveAsImage: {
            show: true,
            title: "保存为图片",
            name: "近三个月总体销售情况"
          }
        }
      },
      calculable: false,
      xAxis: {
        type: 'category',
        data: {{ bar_one_data.xaxis | safe
  }},
  axisLabel: {
    textStyle: {
      color: 'black',
        fontSize: "9",
          fontWeight: 'bold',
                },
    rotate: 45,
      interval: 0,
            }
        },
  yAxis: [{
    type: 'value'
  }],
    series: [{
      name: '销售额',
      type: 'bar',
      data: {{ bar_one_data.sale_data | safe }},
      markPoint: {
      data: [{
        type: 'max',
        name: '最大值',
      }, {
        type: 'min',
        name: '最小值'
      }],
      label: {
        show: false,
        position: 'top',
        textStyle: {
          fontSize: 12,
          fontWeight: 'bold',
          color: 'black'
        }
      },
    },
      markLine: {
      data: [{
        type: 'average',
        name: '平均值'
      }],
    }
            }, {
      name: '净利润',
      type: 'bar',
      data: {{ bar_one_data.pure_data | safe }},
      markPoint: {
      data: [{
        type: 'max',
        name: '最大值',
      }, {
        type: 'min',
        name: '最小值'
      }],
    },
      markLine: {
      data: [{
        type: 'average',
        name: '平均值'
      }]
    }
            }]
        }
  echartBar.setOption(option);
    }


  //echart Donut 2

  if ($('#echart_donut').length) {

    var echartDonut = echarts.init(document.getElementById('echart_donut'), theme);

    echartDonut.setOption({
      tooltip: {
        trigger: 'item',
        formatter: "{b} : {c} ({d}%)"
      },
      calculable: true,
      legend: {
        x: 'center',
        y: 'bottom',
        data: {{ donut_data.type_name | safe }},
    },
  toolbox: {
    show: true,
      feature: {
      magicType: {
        show: true,
          type: ['pie', 'funnel'],
            option: {
          funnel: {
            x: '25%',
              width: '50%',
                funnelAlign: 'center',
                  max: 1548
          }
        }
      },
      restore: {
        show: true,
          title: "刷新",
            },
      saveAsImage: {
        show: true,
          title: "保存为图片",
            name: "销售额类别分布情况",
            }
    }
  },
  series: [{
    name: '',
    type: 'pie',
    radius: ['35%', '55%'],
    itemStyle: {
      normal: {
        label: {
          show: true,
          textStyle: {
            fontSize: '10',
            fontWeight: 'normal'
          }
        },
        labelLine: {
          show: true
        }
      },
      emphasis: {
        label: {
          show: true,
          position: 'center',
          textStyle: {
            fontSize: '12',
            fontWeight: 'normal'
          }
        }
      }
    },
    data: {{ donut_data.pie_data | safe }}
    }]
});

}

  //echart Bar Horizontal 3

  if ($('#echart_bar_horizontal').length) {

    var echartBar = echarts.init(document.getElementById('echart_bar_horizontal'), theme);

    echartBar.setOption({
      tooltip: {
        trigger: 'axis'
      },
      legend: {
        x: 100,
        data: ['销售额', '净利润']
      },
      toolbox: {
        show: true,
        feature: {
          saveAsImage: {
            show: true,
            title: "保存为图片",
            name: "销售额前五商店"
          }
        }
      },
      calculable: true,
      xAxis: [{
        type: 'value',
        boundaryGap: [0, 0.01]
      }],
      yAxis: [{
        type: 'category',
        data: {{ bar_hrz_data.yaxis | safe }},
      axisLabel: {
      textStyle: {
        color: 'black',
        fontSize: "10",
        fontWeight: 'normal',
      },
      rotate: 0,
      fontSize: 12,
      interval: 0,
    },
       
    }],
  series: [{
    name: '销售额',
    type: 'bar',
    data: {{ bar_hrz_data.sale_data | safe }}
    }, {
    name: '净利润',
    type: 'bar',
    data: {{ bar_hrz_data.pure_data | safe }}
    }],
    grid: {
    left: '17%'
  }
});

}

  //echart Line 5
  if ($('#echart_line').length) {

    var echartLine = echarts.init(document.getElementById('echart_line'), theme);

    echartLine.setOption({

      tooltip: {
        trigger: 'axis'
      },
      legend: {
        x: 'center',
        y: '',
        data: ['销售额', '净利润', '进货金额']
      },
      toolbox: {
        show: true,
        x: 'right',
        orient: 'vertical',
        feature: {
          magicType: {
            show: true,
            title: {
              line: '线型图',
              bar: '柱状图',
            },
            type: ['line', 'bar']
          },
          restore: {
            show: true,
            title: "刷新"
          },
          saveAsImage: {
            show: true,
            title: "保存为图片",
            name: "运营记录的时间分布情况"
          }
        }
      },
      calculable: true,
      xAxis: [{
        type: 'category',
        boundaryGap: false,
        data: ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期日']
      }],
      yAxis: [{
        type: 'value'
      }],
      series: [{
        name: '销售额',
        type: 'line',
        smooth: true,
        itemStyle: {
          normal: {
            areaStyle: {
              type: 'default'
            }
          }
        },
        data: {{ line_data.sale_data | safe }}
    }, {
    name: '净利润',
      type: 'line',
        smooth: true,
          itemStyle: {
      normal: {
        areaStyle: {
          type: 'default'
        }
      }
    },
    data: { { line_data.pure_data | safe } }
  }, {
    name: '进货金额',
      type: 'line',
        smooth: true,
          itemStyle: {
      normal: {
        areaStyle: {
          type: 'default'
        }
      }
    },
    data: { { line_data.order_data | safe } }
  }]
});


  //echart Gauge 6
  if ($('#echart_gauge').length) {

    var echartGauge = echarts.init(document.getElementById('echart_gauge'), theme);

    echartGauge.setOption({
      toolbox: {
        show: true,
        x: 'right',
        feature: {
          saveAsImage: {
            show: true,
            title: "保存为图片",
            name: "销售净利率"
          }
        }
      },
      series: [{
        name: 'Performance',
        type: 'gauge',
        center: ['50%', '50%'],
        startAngle: 140,
        endAngle: -140,
        min: 0,
        max: 100,
        precision: 0,
        splitNumber: 10,
        axisLine: {
          show: true,
          lineStyle: {
            color: [
              [0.2, 'lightgreen'],
              [0.4, 'orange'],
              [0.8, 'skyblue'],
              [1, '#ff4500']
            ],
            width: 30
          }
        },
        axisTick: {
          show: true,
          splitNumber: 5,
          length: 8,
          lineStyle: {
            color: '#eee',
            width: 1,
            type: 'solid'
          }
        },
        axisLabel: {
          show: true,
          formatter: function (v) {
            switch (v + '') {
              case '10':
                return '10%';
              case '30':
                return '30%';
              case '60':
                return '60%';
              case '90':
                return '90%';
              default:
                return '';
            }
          },
          textStyle: {
            color: '#333'
          }
        },
        splitLine: {
          show: true,
          length: 30,
          lineStyle: {
            color: '#eee',
            width: 2,
            type: 'solid'
          }
        },
        pointer: {
          length: '80%',
          width: 8,
          color: 'auto'
        },
        title: {
          show: true,
          offsetCenter: ['-65%', -10],
          textStyle: {
            color: '#333',
            fontSize: 15
          }
        },
        detail: {
          show: true,
          backgroundColor: 'rgba(0,0,0,0)',
          borderWidth: 0,
          borderColor: '#ccc',
          width: 100,
          height: 40,
          offsetCenter: ['-60%', 10],
          formatter: '{value}%',
          textStyle: {
            color: 'auto',
            fontSize: 30
          }
        },
        data: [{
          value: {{ gauge_rate| safe }},
      name: ''
        }]
    }]
});

}

//echart Map 4



// if ($('#echart_world_map').length) {

//     var myChart = echarts.init(document.getElementById('echart_world_map'), theme);

//     var option = {
//         title: {
//             text: '各地区销售额分布情况',
//             textStyle: {
//                 color: '#102C57',
//             },
//             x: 'center',
//             y: 'top'
//         },
//         tooltip: {
//             trigger: 'item',
//             formatter: function (params) {
//                 return params.name + ' : ' + params.value;
//             },
//             showDelay: 0,
//             transitionDuration: 0.2
//         },
//         toolbox: {
//             show: true,
//             orient: 'vertical',
//             x: 'right',
//             feature: {
//                 mark: {
//                     show: true
//                 },
//                 restore: {
//                     show: true,
//                     title: "刷新"
//                 },
//                 saveAsImage: {
//                     show: true,
//                     title: "保存为图片",
//                     name: "地区分布"
//                 }
//             }
//         },
//         dataRange: {
//             min: {{ map_data.min_value|safe }},
//             max: {{ map_data.max_value|safe }},
//             text: ['高', '低'],
//             realtime: false,
//             calculable: true,
//             color: ['#087E65', '#26B99A', '#CBEAE3'],
//             x: '750'
//             // color: ['green', '#00DFA2', 'lightgray']
//         },
//         series: [
//         {
//             type: 'map',
//             mapType: 'china',
//             selectedMode: 'single',
//             label: {
//                 show: true
//             },
//             mapLocation: {
//                 y: 60
//             },
//             roam: true,
//             itemStyle: {
//                 emphasis: {
//                     areaStyle: {
//                         color: '#99d2dd'
//                     },
//                     color: '#313695',
//                     label: {
//                         show: true,
//                     },
//                 },
//             },
//             data: {{ map_data.sale_data|safe }}
//         }
//     ]
//     };

//     myChart.setOption(option);}




}


</script>

{% endblock javascripts %}